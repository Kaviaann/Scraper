const puppeteer = require("puppeteer");





(async () => {
    
    const browser = await puppeteer.launch({
        headless : true
    })

    const page = await browser.newPage()

    await page.goto('https://www.youtube.com/results?search_query=billie%20eilish')
    
    // Tunggu hingga hasil pencarian dimuat sepenuhnya
    await page.waitForSelector('#contents');

    // Ambil judul dan URL video dari hasil pencarian
    const searchResults = await page.$$eval('#contents > ytd-video-renderer', async results => {
        const data = [];

        for (const result of results) {
            const titleElement = result.querySelector('#video-title');
            const thumbnailElement = result.querySelector('yt-image')
            const title = titleElement ? titleElement.textContent.trim() : 'Unknown';
            const url = titleElement ? 'https://www.youtube.com' + titleElement.getAttribute('href') : '';
            const thumbnail = thumbnailElement ? 'https://i.ytimg.com/vi/' + (titleElement.getAttribute('href').split('=')[1]?.slice(0, 11) || titleElement.getAttribute('href').split('/')[2]) + '/hq720.jpg' : "Unknown"

            data.push(`Title : ${title}\nThumbnail : ${thumbnail}\nUrl : ${url}`);
        }

        return data;
    });

    console.log('Hasil Pencarian YouTube:');
    console.log(searchResults.join('\n\n'));

    await browser.close();

})();
